<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CORS Proxy</title>
  <style>
    :root { color-scheme: light dark; }
    :root {
      --bg: #ffffff;
      --fg: #111111;
      --border-color: rgba(0,0,0,0.08);
      --card-bg: #ffffff;
      --pre-bg: #f3f4f6;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b0b0c;
        --fg: #e5e7eb;
        --border-color: rgba(255,255,255,0.12);
        --card-bg: #121316;
        --pre-bg: rgba(127,127,127,0.12);
      }
    }
    [data-theme="light"] {
      color-scheme: light;
      --bg: #ffffff;
      --fg: #111111;
      --border-color: rgba(0,0,0,0.08);
      --card-bg: #ffffff;
      --pre-bg: #f3f4f6;
    }
    [data-theme="dark"] {
      color-scheme: dark;
      --bg: #0b0b0c;
      --fg: #e5e7eb;
      --border-color: rgba(255,255,255,0.12);
      --card-bg: #121316;
      --pre-bg: rgba(127,127,127,0.12);
    }
    body { font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif; margin: 0; line-height: 1.6; background: var(--bg); color: var(--fg); }
    header { padding: 24px 16px; border-bottom: 1px solid var(--border-color); }
    main { max-width: 880px; padding: 24px 16px 64px; margin: 0 auto; }
    h1 { font-size: 28px; margin: 0 0 8px; }
    h2 { font-size: 20px; margin-top: 24px; }
    code, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    pre { background: var(--pre-bg); padding: 12px; border-radius: 8px; overflow: auto; }
    .note { font-size: 12px; opacity: 0.8; }
    .card { border: 1px solid var(--border-color); background: var(--card-bg); border-radius: 10px; padding: 16px; margin: 16px 0; }
    a { color: inherit; }
    .header-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; max-width: 880px; margin: 0 auto; }
    .theme-switcher { display: inline-flex; align-items: center; gap: 8px; font-size: 14px; }
    .icon-btn { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; padding: 0; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--fg); cursor: pointer; }
    .icon-btn:hover { filter: brightness(0.98); }
    .icon { width: 18px; height: 18px; display: block; }
    footer { border-top: 1px solid rgba(0,0,0,0.08); padding: 16px; text-align: center; }
    footer a { text-decoration: none; }
  </style>
</head>
<body>
  <header>
    <div class="header-row">
      <div>
        <h1>CORS Proxy</h1>
        <div class="note">A tiny proxy that forwards any request and replies with proper CORS headers.</div>
      </div>
      <div class="theme-switcher" aria-label="Theme">
        <button class="icon-btn" id="theme-toggle" aria-label="Theme: System" title="Theme: System">
          <!-- System (monitor) -->
          <svg class="icon icon-system" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <rect x="3" y="4" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M8 20h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 16v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <!-- Light (sun) -->
          <svg class="icon icon-light" style="display:none" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 4V2M12 22v-2M4.93 4.93 3.52 3.52M20.48 20.48l-1.41-1.41M4 12H2M22 12h-2M4.93 19.07 3.52 20.48M20.48 3.52l-1.41 1.41" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/>
          </svg>
          <!-- Dark (moon) -->
          <svg class="icon icon-dark" style="display:none" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
      </div>
    </div>
  </header>
  <main>
    <section class="card">
      <h2>What is CORS and Why?</h2>
      <p>
        CORS (Cross-Origin Resource Sharing) is a browser security feature that restricts scripts on one
        origin from calling APIs on a different origin unless the destination explicitly allows it via
        response headers like <code>Access-Control-Allow-Origin</code>.
      </p>
      <p>
        Without the right headers from the API, browsers block requests made by frontend apps running on a
        different domain, port, or protocol.
      </p>
    </section>

    <section class="card">
      <h2>How does this help fix CORS?</h2>
      <p>
        This service sits between your frontend and the target API. Your browser talks to this proxy
        (same origin as your app or allowed by your app), and the proxy forwards the request to the actual
        API, then returns the response with the required CORS headers so the browser accepts it.
      </p>
      <ul>
        <li>Adds <code>Access-Control-Allow-Origin</code> and optional credentials headers.</li>
        <li>Handles preflight <code>OPTIONS</code> requests.</li>
        <li>Streams bodies and files without buffering.</li>
      </ul>
    </section>

    <section class="card">
      <h2>How to use</h2>
      <p>There are two simple ways to target an upstream API:</p>
      <ol>
        <li>
          <strong>Path-embedded full URL</strong> (recommended for simple use and for domains like
          <code>cors.utilitytool.app/&lt;url&gt;</code>):
          <pre><code id="ex-direct"></code></pre>
          In browsers, percent-encode the full URL:
          <pre><code id="ex-encoded"></code></pre>
        </li>
      </ol>
    </section>

    <section class="card">
      <h2>Quick test with curl</h2>
      <pre><code id="ex-curl"></code></pre>
    </section>
  </main>
  <footer>
    <a id="lnk-linkedin" href="#" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    Â·
    <a id="lnk-github" href="#" target="_blank" rel="noopener noreferrer">GitHub</a>
  </footer>
  <script>
    (function() {
      var storageKey = 'theme-preference';
      var toggle = document.getElementById('theme-toggle');
      var root = document.documentElement;
      var media = window.matchMedia('(prefers-color-scheme: dark)');
      var modes = ['system', 'light', 'dark'];

      function showIcon(mode) {
        var sys = toggle.querySelector('.icon-system');
        var light = toggle.querySelector('.icon-light');
        var dark = toggle.querySelector('.icon-dark');
        sys.style.display = mode === 'system' ? 'block' : 'none';
        light.style.display = mode === 'light' ? 'block' : 'none';
        dark.style.display = mode === 'dark' ? 'block' : 'none';
        toggle.setAttribute('aria-label', 'Theme: ' + mode.charAt(0).toUpperCase() + mode.slice(1));
        toggle.title = 'Theme: ' + mode.charAt(0).toUpperCase() + mode.slice(1);
      }

      function applyTheme(mode) {
        if (mode === 'light') {
          root.setAttribute('data-theme', 'light');
        } else if (mode === 'dark') {
          root.setAttribute('data-theme', 'dark');
        } else {
          root.removeAttribute('data-theme');
        }
        showIcon(mode);
      }

      function currentPreference() {
        return localStorage.getItem(storageKey) || 'system';
      }

      function setPreference(mode) {
        if (mode === 'system') {
          localStorage.removeItem(storageKey);
        } else {
          localStorage.setItem(storageKey, mode);
        }
        applyTheme(mode);
      }

      function nextMode(mode) {
        var idx = modes.indexOf(mode);
        return modes[(idx + 1) % modes.length];
      }

      // Initialize
      var initial = currentPreference();
      applyTheme(initial);

      // Update on click: cycle modes
      toggle.addEventListener('click', function(){
        var now = currentPreference();
        setPreference(nextMode(now));
      });

      // If in system mode, react to OS changes
      media.addEventListener && media.addEventListener('change', function() {
        if (currentPreference() === 'system') applyTheme('system');
      });
    })();
    (function() {
      // Fill example URLs with current origin
      var origin = window.location.origin.replace(/\/$/, '');
      var exDirect = document.getElementById('ex-direct');
      var exEncoded = document.getElementById('ex-encoded');
      var exCurl = document.getElementById('ex-curl');
      var target = 'https://api.example.com/v1/users?active=true';
      var encoded = encodeURIComponent(target);
      if (exDirect) exDirect.textContent = origin + '/https://api.example.com/v1/users?active=true';
      if (exEncoded) exEncoded.textContent = origin + '/' + encoded;
      if (exCurl) exCurl.textContent = 'curl "' + origin + '/https://httpbin.org/anything?x=1"';
    })();
    (function(){
      // Configure social links from server-provided env
      var ln = document.getElementById('lnk-linkedin');
      var gh = document.getElementById('lnk-github');
      var cfg = (window.__CONFIG || {});
      if (ln && cfg.linkedin) ln.href = cfg.linkedin;
      if (gh && cfg.github) gh.href = cfg.github;
    })();
  </script>
  <script src="/env.js"></script>
</body>
</html>
